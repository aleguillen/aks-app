# -----------------------------------------------------------------------------
# .SYNOPSIS
#   This is the General Variables definition.   
#   Do not set secret values as plain text in this file.
#   RENAME THIS FILE FROM CHANGEME.yml TO .yml

# .DESCRIPTION
#   This variables file setup pipeline input variables:
#   For more information on how to use yaml schema variables: 
#     1. https://docs.microsoft.com/en-us/azure/devops/pipelines/yaml-schema?view=azure-devops&tabs=schema%2Cparameter-schema#variables
#     2. https://docs.microsoft.com/en-us/azure/devops/pipelines/process/templates?view=azure-devops#variable-reuse

# .ASSUMPTIONS:
#     1. You are referencing this template from an ado pipeline

# .NOTES
#     File Name      : variables.yml
#     Prerequisite   : ADO Multi-Stage Yaml Pipeline
# -----------------------------------------------------------------------------

variables:

  # -----------------------------------------------------------------------------
  # ADO General Variables
  # -----------------------------------------------------------------------------

  # Self-Hosted Agent Pool Name
  ado_agent_pool: 'Default'

  # Azure Service Connection Name - If modified please update Connection Name.
  ado_service_connection_name: 'sc-private-aks-app-azure-subscription' 

  # -----------------------------------------------------------------------------
  # General Azure Variables
  # -----------------------------------------------------------------------------

  # Environment Name: Most common examples: DEV, ACC, PRD, QA (Abbreviate if possible)
  environment: 'dev'

  # Azure region / location. Modify as needed.
  location: 'eastus2' 

  # Application or Project Name abbreviation for all your resources. Use alphanumeric characters only. Avoid special characters. Ex. ado001
  prefix: 'aks001'

  # Azure Common tags. These tags will be apply to all created resources.
  # You can add/remove tags as needed. Example: 
  common_tags: '{
      org_name    = "<replace-me>",
      cost_center = "<replace-me>",
      project     = "<replace-me>",
      project_id  = "<replace-me>",
      created_by  = "<replace-me>",
      environment = "$(environment)"
  }'

  # Resource Group Name - Using Azure standard Naming convention using other 
  # variables values. Ex.: rg-aks001-dev , rg-aks001-eastus2-dev
  # https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/naming-and-tagging
  # This matches to Terraform Locals naming convention.
  resource_group: 'rg-$(prefix)-$(environment)' 

  # Virtual Network Name
  vnet_name: 'vnet-$(prefix)-$(environment)' 

  # -----------------------------------------------------------------------------
  # AKS / Container Registry Variables
  # -----------------------------------------------------------------------------
  
  aks_name: 'aks-$(prefix)-$(environment)' 
  
  acr_name: 'acr$(prefix)$(environment)' 
  
  acr: '$(acr_name).azurecr.io' 
  
  # AKS Version
  # az aks get-versions --location $location --output table
  aks_version: '1.15.11'

  # AKS Service Principal Client ID (AppId)
  aks_service_principal_client_id: '<replace-me>'

  # AKS Service Principal Object ID
  aks_service_principal_id: '<replace-me>'

  # AKS Service Principal Client Secret
  aks_service_principal_client_secret: 'PipelineWillGetThisValueRuntime'
    
  build_id: '$(Build.BuildId)'

  # -----------------------------------------------------------------------------
  # Private Endpoint to ADO Self-Hosted Agent Details Variables
  # -----------------------------------------------------------------------------

  # Resource Group Name for ADO Self-Hosted Agent for Private Endpoint
  pe_rg_name: '<replace-me>'

  # Virtual Network Name for ADO Self-Hosted Agent for Private Endpoint
  pe_vnet_name: '<replace-me>'

  # Subnet name for ADO Self-Hosted Agent for Private Endpoint
  pe_subnet_name: '<replace-me>'

  # Private Endpoint Request
  pe_is_manual_connection: false
  pe_request_message: ''

  # -----------------------------------------------------------------------------
  # Terraform Variables
  # -----------------------------------------------------------------------------

  # Terraform Storage Account Details - Storage Account created for ADO Self-Hosted Agent
  terraformstorageaccount: '<replace-me>'

  terraformstoragerg: '<replace-me>'

  terraformstoragecontainer: 'terraform'

  terraformstorageblobname: '$(prefix)/$(environment)/terraform.tfstate' 

  storagekey: 'PipelineWillGetThisValueRuntime' 
